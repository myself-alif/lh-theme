window.waktools.functions.lh_register_class(class Lh_Ajax{constructor(t){if(!jQuery||!t.block.length)return!1;this.$block=t.block,this.$posts_container=this.$block.find(t.post_container),this.$load_more_btn=this.$block.find(t.load_more_btn),this.$pagination_container=this.$block.find(t.pagination_container),this.current_filter_id=this.$block.data("postsCategory"),this.base_url=this.$block.data("baseUrl")?this.$block.data("baseUrl").replace(/\/$/,""):"",this.buttons_active_style="buttons-active",this.ajax_loading_style="lh-ajax-loading",this.init()}init(){this.$block.addClass("buttons-active")}update_posts_by_filter(t=!1,a=!0,s=!1,e="lh_get_posts_listing",o=!1){const n=this;n.current_filter_id=t,n.args={postsCategory:n.current_filter_id,postsPage:1},n.add_active_classes(),n.update_block_data_attributes(n.args),a&&n.update_address_bar(n.args),jQuery.ajax({url:waktools.wp.ajax_url,method:"POST",data:n.return_data_attributes_object(e),beforeSend:()=>{n.$posts_container.prop("disabled",!0),n.$posts_container.block({message:null})}}).done((function(t){if("success"===t.status&&t.posts){if(s){const a=jQuery("<div></div>").append(jQuery(t.posts));s.remove(".lh-slide"),a.find("li").each((function(){s.add(this)})),s.go("+1")}else n.$posts_container.empty(),jQuery(t.posts).appendTo(n.$posts_container),n.$pagination_container&&t.pagination&&(n.$pagination_container.empty(),jQuery(t.pagination).appendTo(n.$pagination_container)),n.$load_more_btn&&!1!==t.show_more?(n.$load_more_btn.data("page",t.show_more),n.$load_more_btn.attr("data-page",t.show_more)):n.$load_more_btn.parent().remove();n.remove_active_classes()}})).then((()=>{o&&"function"==typeof o&&o()})).always((()=>{n.$posts_container.unblock({fadeOut:0}),n.$posts_container.prop("disabled",!1)}))}update_posts_by_pagination(t,a,s=!1,e="lh_get_posts_listing",o=!1){const n=this;n.args={postsCategory:a,postsPage:t},n.add_active_classes(),n.update_block_data_attributes(n.args),s?n.update_address_bar({postsPage:t}):n.update_address_bar(n.args),jQuery.ajax({url:waktools.wp.ajax_url,method:"POST",data:n.return_data_attributes_object(e),beforeSend:()=>{n.$posts_container.prop("disabled",!0),n.$posts_container.block({message:null})}}).done((function(t){"success"===t.status&&t.posts&&(s?(jQuery("<div></div>").append(jQuery(t.posts)).find("li").each((function(){s.add(this)})),s.go("+1")):(n.$posts_container.empty(),jQuery(t.posts).appendTo(n.$posts_container),n.$pagination_container&&t.pagination&&(n.$pagination_container.empty(),jQuery(t.pagination).appendTo(n.$pagination_container))),n.remove_active_classes())})).then((()=>{o&&"function"==typeof o&&o()})).always((()=>{n.$posts_container.unblock({fadeOut:0}),n.$posts_container.prop("disabled",!1)}))}update_posts_by_more(t,a,s,e=!1,o=!0,n="lh_get_posts_listing",r=!1){const i=this;i.args={postsCategory:a,postsPage:t},i.add_active_classes(),i.update_block_data_attributes(i.args),o&&i.update_address_bar({postsPage:t}),jQuery.ajax({url:waktools.wp.ajax_url,method:"POST",data:i.return_data_attributes_object(n),beforeSend:()=>{s.prop("disabled",!0),s.block({message:null})}}).done((function(t){"success"===t.status&&t.posts&&(!1!==t.show_more?(s.data("page",t.show_more),s.attr("data-page",t.show_more)):s.parent().remove(),i.remove_active_classes(),e?(jQuery("<div></div>").append(jQuery(t.posts)).find("li").each((function(){e.add(this)})),e.go("+1")):jQuery(t.posts).appendTo(i.$posts_container)),"error"===t.status&&s.parent().remove()})).then((()=>{r&&"function"==typeof r&&r()})).always((()=>{s.unblock({fadeOut:0}),s.prop("disabled",!1)}))}search_for_string_with_input(t=!1,a=!1,s="lh_get_contributors_by_search_string",e={search_results_container:".lh-search-results",pagainated_list:".lh-pagination-and-list",input:"#search-input",input_container:".lh-input-container"},o=!1){if(!a||!t)return!1;const n=this,r=t.find(e.search_results_container),i=t.find(e.pagainated_list),d=t.find(e.input),_=t.find(e.input_container);n.add_active_classes(),jQuery.ajax({url:waktools.wp.ajax_url,method:"POST",data:{action:s,search_string:a},beforeSend:()=>{t.prop("disabled",!0),t.block({message:null})}}).done((function(t){"success"===t.status&&t.posts&&(n.remove_active_classes(),r.empty().show(),i.hide(),jQuery(t.posts).appendTo(r)),"error"===t.status&&(r.hide(),i.show())})).always((()=>{d.prop("disabled",!1),_.unblock({fadeOut:0})})).then((()=>{o&&o()}))}return_data_attributes_object(t,a=!1){let s=this.$block;return a.length&&(s=a),{action:t,base_url:s.data("baseUrl"),post_type:s.data("postsType"),posts_category:s.data("postsCategory"),offset:s.data("postsOffset"),posts_per_page:s.data("postsPerPage"),posts_page:s.data("postsPage"),role:s.data("role"),page_id:s.data("pageId"),order_by:s.data("orderBy"),included_ids:s.data("postsIncluded"),featured_ids:s.data("postsFeatured"),excluded_ids:s.data("postsExcluded"),taxonomy_name:s.data("postsTaxonomyName"),posts_max_page:s.data("postsMaxPage"),first_pages_count:s.data("firstPagesCount"),last_pages_count:s.data("lastPagesCount"),around_current_page:s.data("aroundCurrentPage"),display_all_count:s.data("displayAllCount"),template_name:s.data("templateName"),block_name:s.data("blockName"),custom_meta:s.attr("data-custom-meta"),tax_query:s.attr("data-tax-query"),return_fields:s.data("returnFields"),dest_id:s.data("destinationId")}}add_active_classes(){this.$block.addClass(this.ajax_loading_style)}remove_active_classes(){this.$block.removeClass(this.ajax_loading_style)}update_block_data_attributes(t){if(t)for(const a in t){const s=t[a];this.$block.data(a,s)}}update_address_bar(t){const a=t.postsCategory||0,s=t.postsPage||1,e=t.country||0;let o="";0!==a&&(o="category/"+a+"/"),s>1&&(o+="page/"+s+"/"),e.length&&(o+="country/"+e+"/"),history.pushState({},null,this.base_url+"/"+o)}});