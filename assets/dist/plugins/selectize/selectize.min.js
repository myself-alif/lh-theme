/*! For license information please see selectize.min.js.LICENSE.txt */
!function(h,g){"function"==typeof define&&define.amd?define("sifter",g):"object"==typeof exports?module.exports=g():h.Sifter=g()}(this,(function(){var a=function(h,g){this.items=h,this.settings=g||{diacritics:!0}};a.prototype.tokenize=function(h){if(!(h=e(String(h||"").toLowerCase()))||!h.length)return[];var y,O,$,C,x=[],S=h.split(/ +/);for(y=0,O=S.length;y<O;y++){if($=f(S[y]),this.settings.diacritics)for(C in g)g.hasOwnProperty(C)&&($=$.replace(new RegExp(C,"g"),g[C]));x.push({string:S[y],regex:new RegExp($,"i")})}return x},a.prototype.iterator=function(g,y){var O;O=h(g)?Array.prototype.forEach||function(h){for(var g=0,y=this.length;g<y;g++)h(this[g],g,this)}:function(h){for(var g in this)this.hasOwnProperty(g)&&h(this[g],g,this)},O.apply(g,[y])},a.prototype.getScoreFunction=function(h,g){var y,O,$,C;h=this.prepareSearch(h,g),O=h.tokens,y=h.options.fields,$=O.length,C=h.options.nesting;var i=function(h,g){var y,O;return h?-1===(O=(h=String(h||"")).search(g.regex))?0:(y=g.string.length/h.length,0===O&&(y+=.5),y):0},x=function(){var h=y.length;return h?1===h?function(h,g){return i(d(g,y[0],C),h)}:function(g,O){for(var $=0,x=0;$<h;$++)x+=i(d(O,y[$],C),g);return x/h}:function(){return 0}}();return $?1===$?function(h){return x(O[0],h)}:"and"===h.options.conjunction?function(h){for(var g,y=0,C=0;y<$;y++){if((g=x(O[y],h))<=0)return 0;C+=g}return C/$}:function(h){for(var g=0,y=0;g<$;g++)y+=x(O[g],h);return y/$}:function(){return 0}},a.prototype.getSortFunction=function(h,g){var y,O,$,C,x,S,I,_,F,D,P;if(P=!(h=($=this).prepareSearch(h,g)).query&&g.sort_empty||g.sort,F=function(h,y){return"$score"===h?y.score:d($.items[y.id],h,g.nesting)},x=[],P)for(y=0,O=P.length;y<O;y++)(h.query||"$score"!==P[y].field)&&x.push(P[y]);if(h.query){for(D=!0,y=0,O=x.length;y<O;y++)if("$score"===x[y].field){D=!1;break}D&&x.unshift({field:"$score",direction:"desc"})}else for(y=0,O=x.length;y<O;y++)if("$score"===x[y].field){x.splice(y,1);break}for(_=[],y=0,O=x.length;y<O;y++)_.push("desc"===x[y].direction?-1:1);return(S=x.length)?1===S?(C=x[0].field,I=_[0],function(h,g){return I*b(F(C,h),F(C,g))}):function(h,g){var y,O,$;for(y=0;y<S;y++)if($=x[y].field,O=_[y]*b(F($,h),F($,g)))return O;return 0}:null},a.prototype.prepareSearch=function(g,y){if("object"==typeof g)return g;var O=(y=c({},y)).fields,$=y.sort,C=y.sort_empty;return O&&!h(O)&&(y.fields=[O]),$&&!h($)&&(y.sort=[$]),C&&!h(C)&&(y.sort_empty=[C]),{options:y,query:String(g||"").toLowerCase(),tokens:this.tokenize(g),total:0,items:[]}},a.prototype.search=function(h,g){var y,O,$,C,x=this;return O=this.prepareSearch(h,g),g=O.options,h=O.query,C=g.score||x.getScoreFunction(O),h.length?x.iterator(x.items,(function(h,$){y=C(h),(!1===g.filter||y>0)&&O.items.push({score:y,id:$})})):x.iterator(x.items,(function(h,g){O.items.push({score:1,id:g})})),($=x.getSortFunction(O,g))&&O.items.sort($),O.total=O.items.length,"number"==typeof g.limit&&(O.items=O.items.slice(0,g.limit)),O};var b=function(h,g){return"number"==typeof h&&"number"==typeof g?h>g?1:h<g?-1:0:(h=y(String(h||"")))>(g=y(String(g||"")))?1:g>h?-1:0},c=function(h,g){var y,O,$,C;for(y=1,O=arguments.length;y<O;y++)if(C=arguments[y])for($ in C)C.hasOwnProperty($)&&(h[$]=C[$]);return h},d=function(h,g,y){if(h&&g){if(!y)return h[g];for(var O=g.split(".");O.length&&(h=h[O.shift()]););return h}},e=function(h){return(h+"").replace(/^\s+|\s+$|/g,"")},f=function(h){return(h+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},h=Array.isArray||"undefined"!=typeof $&&$.isArray||function(h){return"[object Array]"===Object.prototype.toString.call(h)},g={a:"[aḀḁĂăÂâǍǎȺⱥȦȧẠạÄäÀàÁáĀāÃãÅåąĄÃąĄ]",b:"[b␢βΒB฿𐌁ᛒ]",c:"[cĆćĈĉČčĊċC̄c̄ÇçḈḉȻȼƇƈɕᴄＣｃ]",d:"[dĎďḊḋḐḑḌḍḒḓḎḏĐđD̦d̦ƉɖƊɗƋƌᵭᶁᶑȡᴅＤｄð]",e:"[eÉéÈèÊêḘḙĚěĔĕẼẽḚḛẺẻĖėËëĒēȨȩĘęᶒɆɇȄȅẾếỀềỄễỂểḜḝḖḗḔḕȆȇẸẹỆệⱸᴇＥｅɘǝƏƐε]",f:"[fƑƒḞḟ]",g:"[gɢ₲ǤǥĜĝĞğĢģƓɠĠġ]",h:"[hĤĥĦħḨḩẖẖḤḥḢḣɦʰǶƕ]",i:"[iÍíÌìĬĭÎîǏǐÏïḮḯĨĩĮįĪīỈỉȈȉȊȋỊịḬḭƗɨɨ̆ᵻᶖİiIıɪＩｉ]",j:"[jȷĴĵɈɉʝɟʲ]",k:"[kƘƙꝀꝁḰḱǨǩḲḳḴḵκϰ₭]",l:"[lŁłĽľĻļĹĺḶḷḸḹḼḽḺḻĿŀȽƚⱠⱡⱢɫɬᶅɭȴʟＬｌ]",n:"[nŃńǸǹŇňÑñṄṅŅņṆṇṊṋṈṉN̈n̈ƝɲȠƞᵰᶇɳȵɴＮｎŊŋ]",o:"[oØøÖöÓóÒòÔôǑǒŐőŎŏȮȯỌọƟɵƠơỎỏŌōÕõǪǫȌȍՕօ]",p:"[pṔṕṖṗⱣᵽƤƥᵱ]",q:"[qꝖꝗʠɊɋꝘꝙq̃]",r:"[rŔŕɌɍŘřŖŗṘṙȐȑȒȓṚṛⱤɽ]",s:"[sŚśṠṡṢṣꞨꞩŜŝŠšŞşȘșS̈s̈]",t:"[tŤťṪṫŢţṬṭƮʈȚțṰṱṮṯƬƭ]",u:"[uŬŭɄʉỤụÜüÚúÙùÛûǓǔŰűŬŭƯưỦủŪūŨũŲųȔȕ∪]",v:"[vṼṽṾṿƲʋꝞꝟⱱʋ]",w:"[wẂẃẀẁŴŵẄẅẆẇẈẉ]",x:"[xẌẍẊẋχ]",y:"[yÝýỲỳŶŷŸÿỸỹẎẏỴỵɎɏƳƴ]",z:"[zŹźẐẑŽžŻżẒẓẔẕƵƶ]"},y=function(){var h,y,O,$,C="",x={};for(O in g)if(g.hasOwnProperty(O))for(C+=$=g[O].substring(2,g[O].length-1),h=0,y=$.length;h<y;h++)x[$.charAt(h)]=O;var S=new RegExp("["+C+"]","g");return function(h){return h.replace(S,(function(h){return x[h]})).toLowerCase()}}();return a})),function(h,g){"function"==typeof define&&define.amd?define("microplugin",g):"object"==typeof exports?module.exports=g():h.MicroPlugin=g()}(this,(function(){var h={mixin:function(h){h.plugins={},h.prototype.initializePlugins=function(h){var y,O,$,C=this,x=[];if(C.plugins={names:[],settings:{},requested:{},loaded:{}},g.isArray(h))for(y=0,O=h.length;y<O;y++)"string"==typeof h[y]?x.push(h[y]):(C.plugins.settings[h[y].name]=h[y].options,x.push(h[y].name));else if(h)for($ in h)h.hasOwnProperty($)&&(C.plugins.settings[$]=h[$],x.push($));for(;x.length;)C.require(x.shift())},h.prototype.loadPlugin=function(g){var y=this,O=y.plugins,$=h.plugins[g];if(!h.plugins.hasOwnProperty(g))throw new Error('Unable to find "'+g+'" plugin');O.requested[g]=!0,O.loaded[g]=$.fn.apply(y,[y.plugins.settings[g]||{}]),O.names.push(g)},h.prototype.require=function(h){var g=this,y=g.plugins;if(!g.plugins.loaded.hasOwnProperty(h)){if(y.requested[h])throw new Error('Plugin has circular dependency ("'+h+'")');g.loadPlugin(h)}return y.loaded[h]},h.define=function(g,y){h.plugins[g]={name:g,fn:y}}}},g={isArray:Array.isArray||function(h){return"[object Array]"===Object.prototype.toString.call(h)}};return h})),function(h,g){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],g):"object"==typeof exports?module.exports=g(require("jquery"),require("sifter"),require("microplugin")):h.Selectize=g(h.jQuery,h.Sifter,h.MicroPlugin)}(this,(function(h,g,y){"use strict";var d=function(h,g){if("string"!=typeof g||g.length){var y="string"==typeof g?new RegExp(g,"i"):g,d=function(h){var g=0;if(3===h.nodeType){var O=h.data.search(y);if(O>=0&&h.data.length>0){var $=h.data.match(y),C=document.createElement("span");C.className="highlight";var x=h.splitText(O),S=(x.splitText($[0].length),x.cloneNode(!0));C.appendChild(S),x.parentNode.replaceChild(C,x),g=1}}else if(1===h.nodeType&&h.childNodes&&!/(script|style)/i.test(h.tagName)&&("highlight"!==h.className||"SPAN"!==h.tagName))for(var I=0;I<h.childNodes.length;++I)I+=d(h.childNodes[I]);return g};return h.each((function(){d(this)}))}};h.fn.removeHighlight=function(){return this.find("span.highlight").each((function(){this.parentNode.firstChild.nodeName;var h=this.parentNode;h.replaceChild(this.firstChild,this),h.normalize()})).end()};var e=function(){};e.prototype={on:function(h,g){this._events=this._events||{},this._events[h]=this._events[h]||[],this._events[h].push(g)},off:function(h,g){var y=arguments.length;return 0===y?delete this._events:1===y?delete this._events[h]:(this._events=this._events||{},void(h in this._events!=0&&this._events[h].splice(this._events[h].indexOf(g),1)))},trigger:function(h){if(this._events=this._events||{},h in this._events!=0)for(var g=0;g<this._events[h].length;g++)this._events[h][g].apply(this,Array.prototype.slice.call(arguments,1))}},e.mixin=function(h){for(var g=["on","off","trigger"],y=0;y<g.length;y++)h.prototype[g[y]]=e.prototype[g[y]]};var O=/Mac/.test(navigator.userAgent),$=O?91:17,C=O?18:17,x=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,j=function(h){return void 0!==h},k=function(h){return null==h?null:"boolean"==typeof h?h?"1":"0":h+""},l=function(h){return(h+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},S={before:function(h,g,y){var O=h[g];h[g]=function(){return y.apply(h,arguments),O.apply(h,arguments)}},after:function(h,g,y){var O=h[g];h[g]=function(){var g=O.apply(h,arguments);return y.apply(h,arguments),g}}},o=function(h,g){var y;return function(){var O=this,$=arguments;window.clearTimeout(y),y=window.setTimeout((function(){h.apply(O,$)}),g)}},p=function(h,g,y){var O,$=h.trigger,C={};for(O in h.trigger=function(){var y=arguments[0];if(-1===g.indexOf(y))return $.apply(h,arguments);C[y]=arguments},y.apply(h,[]),h.trigger=$,C)C.hasOwnProperty(O)&&$.apply(h,C[O])},r=function(h){var g={};if("selectionStart"in h)g.start=h.selectionStart,g.length=h.selectionEnd-g.start;else if(document.selection){h.focus();var y=document.selection.createRange(),O=document.selection.createRange().text.length;y.moveStart("character",-h.value.length),g.start=y.text.length-O,g.length=O}return g},t=function(g,y){return g?(w.$testInput||(w.$testInput=h("<span />").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).appendTo("body")),w.$testInput.text(g),function(h,g,y){var O,$,C={};if(y)for(O=0,$=y.length;O<$;O++)C[y[O]]=h.css(y[O]);else C=h.css();g.css(C)}(y,w.$testInput,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]),w.$testInput.width()):0},u=function(h){var g=null,c=function(y,O){var $,C,x,S,I,_,F,D;O=O||{},(y=y||window.event||{}).metaKey||y.altKey||(O.force||!1!==h.data("grow"))&&($=h.val(),y.type&&"keydown"===y.type.toLowerCase()&&(x=(C=y.keyCode)>=48&&C<=57||C>=65&&C<=90||C>=96&&C<=111||C>=186&&C<=222||32===C,46===C||8===C?(D=r(h[0])).length?$=$.substring(0,D.start)+$.substring(D.start+D.length):8===C&&D.start?$=$.substring(0,D.start-1)+$.substring(D.start+1):46===C&&void 0!==D.start&&($=$.substring(0,D.start)+$.substring(D.start+1)):x&&(_=y.shiftKey,F=String.fromCharCode(y.keyCode),$+=F=_?F.toUpperCase():F.toLowerCase())),S=h.attr("placeholder"),!$&&S&&($=S),(I=t($,h)+4)!==g&&(g=I,h.width(I),h.triggerHandler("resize")))};h.on("keydown keyup update blur",c),c()},v=function(h){var g=document.createElement("div");return g.appendChild(h.cloneNode(!0)),g.innerHTML},w=function(y,O){var $,C,x,S,I=this;(S=y[0]).selectize=I;var _=window.getComputedStyle&&window.getComputedStyle(S,null);if(x=(x=_?_.getPropertyValue("direction"):S.currentStyle&&S.currentStyle.direction)||y.parents("[dir]:first").attr("dir")||"",h.extend(I,{order:0,settings:O,$input:y,tabIndex:y.attr("tabindex")||"",tagType:"select"===S.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(x),eventNS:".selectize"+ ++w.count,highlightedValue:null,isBlurring:!1,isOpen:!1,isDisabled:!1,isRequired:y.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===O.loadThrottle?I.onSearchChange:o(I.onSearchChange,O.loadThrottle)}),I.sifter=new g(this.options,{diacritics:O.diacritics}),I.settings.options){for($=0,C=I.settings.options.length;$<C;$++)I.registerOption(I.settings.options[$]);delete I.settings.options}if(I.settings.optgroups){for($=0,C=I.settings.optgroups.length;$<C;$++)I.registerOptionGroup(I.settings.optgroups[$]);delete I.settings.optgroups}I.settings.mode=I.settings.mode||(1===I.settings.maxItems?"single":"multi"),"boolean"!=typeof I.settings.hideSelected&&(I.settings.hideSelected="multi"===I.settings.mode),I.initializePlugins(I.settings.plugins),I.setupCallbacks(),I.setupTemplates(),I.setup()};return e.mixin(w),void 0!==y?y.mixin(w):function(h,g){g||(g={}),console.error("Selectize: Dependency MicroPlugin is missing"),g.explanation&&(console.group&&console.group(),console.error(g.explanation),console.group&&console.groupEnd())}(0,{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'}),h.extend(w.prototype,{setup:function(){var g,y,S,I,_,F,D,P,A,z,T=this,q=T.settings,N=T.eventNS,E=h(window),H=h(document),L=T.$input;if(D=T.settings.mode,P=L.attr("class")||"",g=h("<div>").addClass(q.wrapperClass).addClass(P).addClass(D),y=h("<div>").addClass(q.inputClass).addClass("items").appendTo(g),S=h('<input type="text" autocomplete="off" />').appendTo(y).attr("tabindex",L.is(":disabled")?"-1":T.tabIndex),F=h(q.dropdownParent||g),I=h("<div>").addClass(q.dropdownClass).addClass(D).hide().appendTo(F),_=h("<div>").addClass(q.dropdownContentClass).appendTo(I),(z=L.attr("id"))&&(S.attr("id",z+"-selectized"),h("label[for='"+z+"']").attr("for",z+"-selectized")),T.settings.copyClassesToDropdown&&I.addClass(P),g.css({width:L[0].style.width}),T.plugins.names.length&&(A="plugin-"+T.plugins.names.join(" plugin-"),g.addClass(A),I.addClass(A)),(null===q.maxItems||q.maxItems>1)&&1===T.tagType&&L.attr("multiple","multiple"),T.settings.placeholder&&S.attr("placeholder",q.placeholder),!T.settings.splitOn&&T.settings.delimiter){var V=T.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");T.settings.splitOn=new RegExp("\\s*"+V+"+\\s*")}L.attr("autocorrect")&&S.attr("autocorrect",L.attr("autocorrect")),L.attr("autocapitalize")&&S.attr("autocapitalize",L.attr("autocapitalize")),S[0].type=L[0].type,T.$wrapper=g,T.$control=y,T.$control_input=S,T.$dropdown=I,T.$dropdown_content=_,I.on("mouseenter mousedown click","[data-disabled]>[data-selectable]",(function(h){h.stopImmediatePropagation()})),I.on("mouseenter","[data-selectable]",(function(){return T.onOptionHover.apply(T,arguments)})),I.on("mousedown click","[data-selectable]",(function(){return T.onOptionSelect.apply(T,arguments)})),function(h,g,y,O){h.on(g,y,(function(g){for(var y=g.target;y&&y.parentNode!==h[0];)y=y.parentNode;return g.currentTarget=y,O.apply(this,[g])}))}(y,"mousedown","*:not(input)",(function(){return T.onItemSelect.apply(T,arguments)})),u(S),y.on({mousedown:function(){return T.onMouseDown.apply(T,arguments)},click:function(){return T.onClick.apply(T,arguments)}}),S.on({mousedown:function(h){h.stopPropagation()},keydown:function(){return T.onKeyDown.apply(T,arguments)},keyup:function(){return T.onKeyUp.apply(T,arguments)},keypress:function(){return T.onKeyPress.apply(T,arguments)},resize:function(){T.positionDropdown.apply(T,[])},blur:function(){return T.onBlur.apply(T,arguments)},focus:function(){return T.ignoreBlur=!1,T.onFocus.apply(T,arguments)},paste:function(){return T.onPaste.apply(T,arguments)}}),H.on("keydown"+N,(function(h){T.isCmdDown=h[O?"metaKey":"ctrlKey"],T.isCtrlDown=h[O?"altKey":"ctrlKey"],T.isShiftDown=h.shiftKey})),H.on("keyup"+N,(function(h){h.keyCode===C&&(T.isCtrlDown=!1),16===h.keyCode&&(T.isShiftDown=!1),h.keyCode===$&&(T.isCmdDown=!1)})),H.on("mousedown"+N,(function(h){if(T.isFocused){if(h.target===T.$dropdown[0]||h.target.parentNode===T.$dropdown[0])return!1;T.$control.has(h.target).length||h.target===T.$control[0]||T.blur(h.target)}})),E.on(["scroll"+N,"resize"+N].join(" "),(function(){T.isOpen&&T.positionDropdown.apply(T,arguments)})),E.on("mousemove"+N,(function(){T.ignoreHover=!1})),this.revertSettings={$children:L.children().detach(),tabindex:L.attr("tabindex")},L.attr("tabindex",-1).hide().after(T.$wrapper),h.isArray(q.items)&&(T.setValue(q.items),delete q.items),x&&L.on("invalid"+N,(function(h){h.preventDefault(),T.isInvalid=!0,T.refreshState()})),T.updateOriginalInput(),T.refreshItems(),T.refreshState(),T.updatePlaceholder(),T.isSetup=!0,L.is(":disabled")&&T.disable(),T.on("change",this.onChange),L.data("selectize",T),L.addClass("selectized"),T.trigger("initialize"),!0===q.preload&&T.onSearchChange("")},setupTemplates:function(){var g=this,y=g.settings.labelField,O=g.settings.optgroupLabelField,$={optgroup:function(h){return'<div class="optgroup">'+h.html+"</div>"},optgroup_header:function(h,g){return'<div class="optgroup-header">'+g(h[O])+"</div>"},option:function(h,g){return'<div class="option">'+g(h[y])+"</div>"},item:function(h,g){return'<div class="item">'+g(h[y])+"</div>"},option_create:function(h,g){return'<div class="create">Add <strong>'+g(h.input)+"</strong>&hellip;</div>"}};g.settings.render=h.extend({},$,g.settings.render)},setupCallbacks:function(){var h,g,y={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(h in y)y.hasOwnProperty(h)&&(g=this.settings[y[h]])&&this.on(h,g)},onClick:function(h){var g=this;g.isFocused&&g.isOpen||(g.focus(),h.preventDefault())},onMouseDown:function(g){var y=this,O=g.isDefaultPrevented();if(h(g.target),y.isFocused){if(g.target!==y.$control_input[0])return"single"===y.settings.mode?y.isOpen?y.close():y.open():O||y.setActiveItem(null),!1}else O||window.setTimeout((function(){y.focus()}),0)},onChange:function(){this.$input.trigger("change")},onPaste:function(g){var y=this;y.isFull()||y.isInputHidden||y.isLocked?g.preventDefault():y.settings.splitOn&&setTimeout((function(){var g=y.$control_input.val();if(g.match(y.settings.splitOn))for(var O=h.trim(g).split(y.settings.splitOn),$=0,C=O.length;$<C;$++)y.createItem(O[$])}),0)},onKeyPress:function(h){if(this.isLocked)return h&&h.preventDefault();var g=String.fromCharCode(h.keyCode||h.which);return this.settings.create&&"multi"===this.settings.mode&&g===this.settings.delimiter?(this.createItem(),h.preventDefault(),!1):void 0},onKeyDown:function(h){var g=(h.target,this.$control_input[0],this);if(!g.isLocked){switch(h.keyCode){case 65:if(g.isCmdDown)return void g.selectAll();break;case 27:return void(g.isOpen&&(h.preventDefault(),h.stopPropagation(),g.close()));case 78:if(!h.ctrlKey||h.altKey)break;case 40:if(!g.isOpen&&g.hasOptions)g.open();else if(g.$activeOption){g.ignoreHover=!0;var y=g.getAdjacentOption(g.$activeOption,1);y.length&&g.setActiveOption(y,!0,!0)}return void h.preventDefault();case 80:if(!h.ctrlKey||h.altKey)break;case 38:if(g.$activeOption){g.ignoreHover=!0;var $=g.getAdjacentOption(g.$activeOption,-1);$.length&&g.setActiveOption($,!0,!0)}return void h.preventDefault();case 13:return void(g.isOpen&&g.$activeOption&&(g.onOptionSelect({currentTarget:g.$activeOption}),h.preventDefault()));case 37:return void g.advanceSelection(-1,h);case 39:return void g.advanceSelection(1,h);case 9:return g.settings.selectOnTab&&g.isOpen&&g.$activeOption&&(g.onOptionSelect({currentTarget:g.$activeOption}),g.isFull()||h.preventDefault()),void(g.settings.create&&g.createItem()&&h.preventDefault());case 8:case 46:return void g.deleteSelection(h)}return!g.isFull()&&!g.isInputHidden||(O?h.metaKey:h.ctrlKey)?void 0:void h.preventDefault()}9!==h.keyCode&&h.preventDefault()},onKeyUp:function(h){var g=this;if(g.isLocked)return h&&h.preventDefault();var y=g.$control_input.val()||"";g.lastValue!==y&&(g.lastValue=y,g.onSearchChange(y),g.refreshOptions(),g.trigger("type",y))},onSearchChange:function(h){var g=this,y=g.settings.load;y&&(g.loadedSearches.hasOwnProperty(h)||(g.loadedSearches[h]=!0,g.load((function(O){y.apply(g,[h,O])}))))},onFocus:function(h){var g=this,y=g.isFocused;if(g.isDisabled)return g.blur(),h&&h.preventDefault(),!1;g.ignoreFocus||(g.isFocused=!0,"focus"===g.settings.preload&&g.onSearchChange(""),y||g.trigger("focus"),g.$activeItems.length||(g.showInput(),g.setActiveItem(null),g.refreshOptions(!!g.settings.openOnFocus)),g.refreshState())},onBlur:function(h,g){var y=this;if(y.isFocused&&(y.isFocused=!1,!y.ignoreFocus)){if(!y.ignoreBlur&&document.activeElement===y.$dropdown_content[0])return y.ignoreBlur=!0,void y.onFocus(h);var d=function(){y.close(),y.setTextboxValue(""),y.setActiveItem(null),y.setActiveOption(null),y.setCaret(y.items.length),y.refreshState(),g&&g.focus&&g.focus(),y.isBlurring=!1,y.ignoreFocus=!1,y.trigger("blur")};y.isBlurring=!0,y.ignoreFocus=!0,y.settings.create&&y.settings.createOnBlur?y.createItem(null,!1,d):d()}},onOptionHover:function(h){this.ignoreHover||this.setActiveOption(h.currentTarget,!1)},onOptionSelect:function(g){var y,O,$=this;g.preventDefault&&(g.preventDefault(),g.stopPropagation()),(O=h(g.currentTarget)).hasClass("create")?$.createItem(null,(function(){$.settings.closeAfterSelect&&$.close()})):void 0!==(y=O.attr("data-value"))&&($.lastQuery=null,$.setTextboxValue(""),$.addItem(y),$.settings.closeAfterSelect?$.close():!$.settings.hideSelected&&g.type&&/mouse/.test(g.type)&&$.setActiveOption($.getOption(y)))},onItemSelect:function(h){var g=this;g.isLocked||"multi"===g.settings.mode&&(h.preventDefault(),g.setActiveItem(h.currentTarget,h))},load:function(h){var g=this,y=g.$wrapper.addClass(g.settings.loadingClass);g.loading++,h.apply(g,[function(h){g.loading=Math.max(g.loading-1,0),h&&h.length&&(g.addOption(h),g.refreshOptions(g.isFocused&&!g.isInputHidden)),g.loading||y.removeClass(g.settings.loadingClass),g.trigger("load",h)}])},setTextboxValue:function(h){var g=this.$control_input;g.val()!==h&&(g.val(h).triggerHandler("update"),this.lastValue=h)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(h,g){p(this,g?[]:["change"],(function(){this.clear(g),this.addItems(h,g)}))},setActiveItem:function(g,y){var O,$,C,x,S,I,_,F,D=this;if("single"!==D.settings.mode){if(!(g=h(g)).length)return h(D.$activeItems).removeClass("active"),D.$activeItems=[],void(D.isFocused&&D.showInput());if("mousedown"===(O=y&&y.type.toLowerCase())&&D.isShiftDown&&D.$activeItems.length){for(F=D.$control.children(".active:last"),(x=Array.prototype.indexOf.apply(D.$control[0].childNodes,[F[0]]))>(S=Array.prototype.indexOf.apply(D.$control[0].childNodes,[g[0]]))&&(_=x,x=S,S=_),$=x;$<=S;$++)I=D.$control[0].childNodes[$],-1===D.$activeItems.indexOf(I)&&(h(I).addClass("active"),D.$activeItems.push(I));y.preventDefault()}else"mousedown"===O&&D.isCtrlDown||"keydown"===O&&this.isShiftDown?g.hasClass("active")?(C=D.$activeItems.indexOf(g[0]),D.$activeItems.splice(C,1),g.removeClass("active")):D.$activeItems.push(g.addClass("active")[0]):(h(D.$activeItems).removeClass("active"),D.$activeItems=[g.addClass("active")[0]]);D.hideInput(),this.isFocused||D.focus()}},setActiveOption:function(g,y,O){var $,C,x,S,I,_=this;_.$activeOption&&_.$activeOption.removeClass("active"),_.$activeOption=null,(g=h(g)).length&&(_.$activeOption=g.addClass("active"),!y&&j(y)||($=_.$dropdown_content.height(),C=_.$activeOption.outerHeight(!0),y=_.$dropdown_content.scrollTop()||0,S=x=_.$activeOption.offset().top-_.$dropdown_content.offset().top+y,I=x-$+C,x+C>$+y?_.$dropdown_content.stop().animate({scrollTop:I},O?_.settings.scrollDuration:0):x<y&&_.$dropdown_content.stop().animate({scrollTop:S},O?_.settings.scrollDuration:0)))},selectAll:function(){var h=this;"single"!==h.settings.mode&&(h.$activeItems=Array.prototype.slice.apply(h.$control.children(":not(input)").addClass("active")),h.$activeItems.length&&(h.hideInput(),h.close()),h.focus())},hideInput:function(){var h=this;h.setTextboxValue(""),h.$control_input.css({opacity:0,position:"absolute",left:h.rtl?1e4:-1e4}),h.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var h=this;h.isDisabled||(h.ignoreFocus=!0,h.$control_input[0].focus(),window.setTimeout((function(){h.ignoreFocus=!1,h.onFocus()}),0))},blur:function(h){this.$control_input[0].blur(),this.onBlur(null,h)},getScoreFunction:function(h){return this.sifter.getScoreFunction(h,this.getSearchOptions())},getSearchOptions:function(){var h=this.settings,g=h.sortField;return"string"==typeof g&&(g=[{field:g}]),{fields:h.searchField,conjunction:h.searchConjunction,sort:g,nesting:h.nesting}},search:function(g){var y,O,$,C=this,x=C.settings,S=this.getSearchOptions();if(x.score&&"function"!=typeof($=C.settings.score.apply(this,[g])))throw new Error('Selectize "score" setting must be a function that returns a function');if(g!==C.lastQuery?(C.lastQuery=g,O=C.sifter.search(g,h.extend(S,{score:$})),C.currentResults=O):O=h.extend(!0,{},C.currentResults),x.hideSelected)for(y=O.items.length-1;y>=0;y--)-1!==C.items.indexOf(k(O.items[y].id))&&O.items.splice(y,1);return O},refreshOptions:function(g){var y,O,$,C,x,S,I,_,F,D,P,A,z,T,q,N;void 0===g&&(g=!0);var E=this,H=h.trim(E.$control_input.val()),L=E.search(H),V=E.$dropdown_content,K=E.$activeOption&&k(E.$activeOption.attr("data-value"));for(C=L.items.length,"number"==typeof E.settings.maxOptions&&(C=Math.min(C,E.settings.maxOptions)),x={},S=[],y=0;y<C;y++)for(I=E.options[L.items[y].id],_=E.render("option",I),F=I[E.settings.optgroupField]||"",O=0,$=(D=h.isArray(F)?F:[F])&&D.length;O<$;O++)F=D[O],E.optgroups.hasOwnProperty(F)||(F=""),x.hasOwnProperty(F)||(x[F]=document.createDocumentFragment(),S.push(F)),x[F].appendChild(_);for(this.settings.lockOptgroupOrder&&S.sort((function(h,g){return(E.optgroups[h].$order||0)-(E.optgroups[g].$order||0)})),P=document.createDocumentFragment(),y=0,C=S.length;y<C;y++)F=S[y],E.optgroups.hasOwnProperty(F)&&x[F].childNodes.length?((A=document.createDocumentFragment()).appendChild(E.render("optgroup_header",E.optgroups[F])),A.appendChild(x[F]),P.appendChild(E.render("optgroup",h.extend({},E.optgroups[F],{html:v(A),dom:A})))):P.appendChild(x[F]);if(V.html(P),E.settings.highlight&&(V.removeHighlight(),L.query.length&&L.tokens.length))for(y=0,C=L.tokens.length;y<C;y++)d(V,L.tokens[y].regex);if(!E.settings.hideSelected)for(y=0,C=E.items.length;y<C;y++)E.getOption(E.items[y]).addClass("selected");(z=E.canCreate(H))&&(V.prepend(E.render("option_create",{input:H})),N=h(V[0].childNodes[0])),E.hasOptions=L.items.length>0||z,E.hasOptions?(L.items.length>0?((q=K&&E.getOption(K))&&q.length?T=q:"single"===E.settings.mode&&E.items.length&&(T=E.getOption(E.items[0])),T&&T.length||(T=N&&!E.settings.addPrecedence?E.getAdjacentOption(N,1):V.find("[data-selectable]:first"))):T=N,E.setActiveOption(T),g&&!E.isOpen&&E.open()):(E.setActiveOption(null),g&&E.isOpen&&E.close())},addOption:function(g){var y,O,$,C=this;if(h.isArray(g))for(y=0,O=g.length;y<O;y++)C.addOption(g[y]);else($=C.registerOption(g))&&(C.userOptions[$]=!0,C.lastQuery=null,C.trigger("option_add",$,g))},registerOption:function(h){var g=k(h[this.settings.valueField]);return null!=g&&!this.options.hasOwnProperty(g)&&(h.$order=h.$order||++this.order,this.options[g]=h,g)},registerOptionGroup:function(h){var g=k(h[this.settings.optgroupValueField]);return!!g&&(h.$order=h.$order||++this.order,this.optgroups[g]=h,g)},addOptionGroup:function(h,g){g[this.settings.optgroupValueField]=h,(h=this.registerOptionGroup(g))&&this.trigger("optgroup_add",h,g)},removeOptionGroup:function(h){this.optgroups.hasOwnProperty(h)&&(delete this.optgroups[h],this.renderCache={},this.trigger("optgroup_remove",h))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(g,y){var O,$,C,x,S,I,_,F=this;if(g=k(g),C=k(y[F.settings.valueField]),null!==g&&F.options.hasOwnProperty(g)){if("string"!=typeof C)throw new Error("Value must be set in option data");_=F.options[g].$order,C!==g&&(delete F.options[g],-1!==(x=F.items.indexOf(g))&&F.items.splice(x,1,C)),y.$order=y.$order||_,F.options[C]=y,S=F.renderCache.item,I=F.renderCache.option,S&&(delete S[g],delete S[C]),I&&(delete I[g],delete I[C]),-1!==F.items.indexOf(C)&&(O=F.getItem(g),$=h(F.render("item",y)),O.hasClass("active")&&$.addClass("active"),O.replaceWith($)),F.lastQuery=null,F.isOpen&&F.refreshOptions(!1)}},removeOption:function(h,g){var y=this;h=k(h);var O=y.renderCache.item,$=y.renderCache.option;O&&delete O[h],$&&delete $[h],delete y.userOptions[h],delete y.options[h],y.lastQuery=null,y.trigger("option_remove",h),y.removeItem(h,g)},clearOptions:function(){var g=this;g.loadedSearches={},g.userOptions={},g.renderCache={};var y=g.options;h.each(g.options,(function(h,O){-1==g.items.indexOf(h)&&delete y[h]})),g.options=g.sifter.items=y,g.lastQuery=null,g.trigger("option_clear")},getOption:function(h){return this.getElementWithValue(h,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(g,y){var O=this.$dropdown.find("[data-selectable]"),$=O.index(g)+y;return $>=0&&$<O.length?O.eq($):h()},getElementWithValue:function(g,y){if(void 0!==(g=k(g))&&null!==g)for(var O=0,$=y.length;O<$;O++)if(y[O].getAttribute("data-value")===g)return h(y[O]);return h()},getItem:function(h){return this.getElementWithValue(h,this.$control.children())},addItems:function(g,y){this.buffer=document.createDocumentFragment();for(var O=this.$control[0].childNodes,$=0;$<O.length;$++)this.buffer.appendChild(O[$]);for(var C=h.isArray(g)?g:[g],x=($=0,C.length);$<x;$++)this.isPending=$<x-1,this.addItem(C[$],y);var S=this.$control[0];S.insertBefore(this.buffer,S.firstChild),this.buffer=null},addItem:function(g,y){p(this,y?[]:["change"],(function(){var O,$,C,x,S,I=this,_=I.settings.mode;g=k(g),-1===I.items.indexOf(g)?I.options.hasOwnProperty(g)&&("single"===_&&I.clear(y),"multi"===_&&I.isFull()||(O=h(I.render("item",I.options[g])),S=I.isFull(),I.items.splice(I.caretPos,0,g),I.insertAtCaret(O),(!I.isPending||!S&&I.isFull())&&I.refreshState(),I.isSetup&&(C=I.$dropdown_content.find("[data-selectable]"),I.isPending||($=I.getOption(g),x=I.getAdjacentOption($,1).attr("data-value"),I.refreshOptions(I.isFocused&&"single"!==_),x&&I.setActiveOption(I.getOption(x))),!C.length||I.isFull()?I.close():I.isPending||I.positionDropdown(),I.updatePlaceholder(),I.trigger("item_add",g,O),I.isPending||I.updateOriginalInput({silent:y})))):"single"===_&&I.close()}))},removeItem:function(g,y){var O,$,C,x=this;O=g instanceof h?g:x.getItem(g),g=k(O.attr("data-value")),-1!==($=x.items.indexOf(g))&&(O.remove(),O.hasClass("active")&&(C=x.$activeItems.indexOf(O[0]),x.$activeItems.splice(C,1)),x.items.splice($,1),x.lastQuery=null,!x.settings.persist&&x.userOptions.hasOwnProperty(g)&&x.removeOption(g,y),$<x.caretPos&&x.setCaret(x.caretPos-1),x.refreshState(),x.updatePlaceholder(),x.updateOriginalInput({silent:y}),x.positionDropdown(),x.trigger("item_remove",g,O))},createItem:function(g,y){var O=this,$=O.caretPos;g=g||h.trim(O.$control_input.val()||"");var C=arguments[arguments.length-1];if("function"!=typeof C&&(C=function(){}),"boolean"!=typeof y&&(y=!0),!O.canCreate(g))return C(),!1;O.lock();var x="function"==typeof O.settings.create?this.settings.create:function(h){var g={};return g[O.settings.labelField]=h,g[O.settings.valueField]=h,g},S=function(h){var g=!1;return function(){g||(g=!0,h.apply(this,arguments))}}((function(h){if(O.unlock(),!h||"object"!=typeof h)return C();var g=k(h[O.settings.valueField]);if("string"!=typeof g)return C();O.setTextboxValue(""),O.addOption(h),O.setCaret($),O.addItem(g),O.refreshOptions(y&&"single"!==O.settings.mode),C(h)})),I=x.apply(this,[g,S]);return void 0!==I&&S(I),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var h=!this.items.length;this.isInvalid=h,this.$control_input.prop("required",h),this.$input.prop("required",!h)},refreshClasses:function(){var g=this,y=g.isFull(),O=g.isLocked;g.$wrapper.toggleClass("rtl",g.rtl),g.$control.toggleClass("focus",g.isFocused).toggleClass("disabled",g.isDisabled).toggleClass("required",g.isRequired).toggleClass("invalid",g.isInvalid).toggleClass("locked",O).toggleClass("full",y).toggleClass("not-full",!y).toggleClass("input-active",g.isFocused&&!g.isInputHidden).toggleClass("dropdown-active",g.isOpen).toggleClass("has-options",!h.isEmptyObject(g.options)).toggleClass("has-items",g.items.length>0),g.$control_input.data("grow",!y&&!O)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(h){var g,y,O,$,C=this;if(h=h||{},1===C.tagType){for(O=[],g=0,y=C.items.length;g<y;g++)$=C.options[C.items[g]][C.settings.labelField]||"",O.push('<option value="'+l(C.items[g])+'" selected="selected">'+l($)+"</option>");O.length||this.$input.attr("multiple")||O.push('<option value="" selected="selected"></option>'),C.$input.html(O.join(""))}else C.$input.val(C.getValue()),C.$input.attr("value",C.$input.val());C.isSetup&&(h.silent||C.trigger("change",C.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var h=this.$control_input;this.items.length?h.removeAttr("placeholder"):h.attr("placeholder",this.settings.placeholder),h.triggerHandler("update",{force:!0})}},open:function(){var h=this;h.isLocked||h.isOpen||"multi"===h.settings.mode&&h.isFull()||(h.focus(),h.isOpen=!0,h.refreshState(),h.$dropdown.css({visibility:"hidden",display:"block"}),h.positionDropdown(),h.$dropdown.css({visibility:"visible"}),h.trigger("dropdown_open",h.$dropdown))},close:function(){var h=this,g=h.isOpen;"single"===h.settings.mode&&h.items.length&&(h.hideInput(),h.isBlurring||h.$control_input.blur()),h.isOpen=!1,h.$dropdown.hide(),h.setActiveOption(null),h.refreshState(),g&&h.trigger("dropdown_close",h.$dropdown)},positionDropdown:function(){var h=this.$control,g="body"===this.settings.dropdownParent?h.offset():h.position();g.top+=h.outerHeight(!0),this.$dropdown.css({width:h[0].getBoundingClientRect().width,top:g.top,left:g.left})},clear:function(h){var g=this;g.items.length&&(g.$control.children(":not(input)").remove(),g.items=[],g.lastQuery=null,g.setCaret(0),g.setActiveItem(null),g.updatePlaceholder(),g.updateOriginalInput({silent:h}),g.refreshState(),g.showInput(),g.trigger("clear"))},insertAtCaret:function(h){var g=Math.min(this.caretPos,this.items.length),y=h[0],O=this.buffer||this.$control[0];0===g?O.insertBefore(y,O.firstChild):O.insertBefore(y,O.childNodes[g]),this.setCaret(g+1)},deleteSelection:function(g){var y,O,$,C,x,S,I,_,F,D=this;if($=g&&8===g.keyCode?-1:1,C=r(D.$control_input[0]),D.$activeOption&&!D.settings.hideSelected&&(I=D.getAdjacentOption(D.$activeOption,-1).attr("data-value")),x=[],D.$activeItems.length){for(F=D.$control.children(".active:"+($>0?"last":"first")),S=D.$control.children(":not(input)").index(F),$>0&&S++,y=0,O=D.$activeItems.length;y<O;y++)x.push(h(D.$activeItems[y]).attr("data-value"));g&&(g.preventDefault(),g.stopPropagation())}else(D.isFocused||"single"===D.settings.mode)&&D.items.length&&($<0&&0===C.start&&0===C.length?x.push(D.items[D.caretPos-1]):$>0&&C.start===D.$control_input.val().length&&x.push(D.items[D.caretPos]));if(!x.length||"function"==typeof D.settings.onDelete&&!1===D.settings.onDelete.apply(D,[x]))return!1;for(void 0!==S&&D.setCaret(S);x.length;)D.removeItem(x.pop());return D.showInput(),D.positionDropdown(),D.refreshOptions(!0),I&&((_=D.getOption(I)).length&&D.setActiveOption(_)),!0},advanceSelection:function(h,g){var y,O,$,C,x,S=this;0!==h&&(S.rtl&&(h*=-1),y=h>0?"last":"first",O=r(S.$control_input[0]),S.isFocused&&!S.isInputHidden?(C=S.$control_input.val().length,(h<0?0===O.start&&0===O.length:O.start===C)&&!C&&S.advanceCaret(h,g)):(x=S.$control.children(".active:"+y)).length&&($=S.$control.children(":not(input)").index(x),S.setActiveItem(null),S.setCaret(h>0?$+1:$)))},advanceCaret:function(h,g){var y,O,$=this;0!==h&&(y=h>0?"next":"prev",$.isShiftDown?(O=$.$control_input[y]()).length&&($.hideInput(),$.setActiveItem(O),g&&g.preventDefault()):$.setCaret($.caretPos+h))},setCaret:function(g){var y,O,$,C,x=this;if(g="single"===x.settings.mode?x.items.length:Math.max(0,Math.min(x.items.length,g)),!x.isPending)for(y=0,O=($=x.$control.children(":not(input)")).length;y<O;y++)C=h($[y]).detach(),y<g?x.$control_input.before(C):x.$control.append(C);x.caretPos=g},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var h=this;h.$input.prop("disabled",!0),h.$control_input.prop("disabled",!0).prop("tabindex",-1),h.isDisabled=!0,h.lock()},enable:function(){var h=this;h.$input.prop("disabled",!1),h.$control_input.prop("disabled",!1).prop("tabindex",h.tabIndex),h.isDisabled=!1,h.unlock()},destroy:function(){var g=this,y=g.eventNS,O=g.revertSettings;g.trigger("destroy"),g.off(),g.$wrapper.remove(),g.$dropdown.remove(),g.$input.html("").append(O.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:O.tabindex}).show(),g.$control_input.removeData("grow"),g.$input.removeData("selectize"),0==--w.count&&w.$testInput&&(w.$testInput.remove(),w.$testInput=void 0),h(window).off(y),h(document).off(y),h(document.body).off(y),delete g.$input[0].selectize},render:function(g,y){var O,$,C="",x=!1,S=this;return"option"!==g&&"item"!==g||(x=!!(O=k(y[S.settings.valueField]))),x&&(j(S.renderCache[g])||(S.renderCache[g]={}),S.renderCache[g].hasOwnProperty(O))?S.renderCache[g][O]:(C=h(S.settings.render[g].apply(this,[y,l])),"option"===g||"option_create"===g?y[S.settings.disabledField]||C.attr("data-selectable",""):"optgroup"===g&&($=y[S.settings.optgroupValueField]||"",C.attr("data-group",$),y[S.settings.disabledField]&&C.attr("data-disabled","")),"option"!==g&&"item"!==g||C.attr("data-value",O||""),x&&(S.renderCache[g][O]=C[0]),C[0])},clearCache:function(h){void 0===h?this.renderCache={}:delete this.renderCache[h]},canCreate:function(h){var g=this;if(!g.settings.create)return!1;var y=g.settings.createFilter;return h.length&&("function"!=typeof y||y.apply(g,[h]))&&("string"!=typeof y||new RegExp(y).test(h))&&(!(y instanceof RegExp)||y.test(h))}}),w.count=0,w.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},h.fn.selectize=function(g){var y=h.fn.selectize.defaults,O=h.extend({},y,g),$=O.dataAttr,C=O.labelField,x=O.valueField,S=O.disabledField,I=O.optgroupField,_=O.optgroupLabelField,F=O.optgroupValueField,m=function(g,y){var S,I,_,F,D=g.attr($);if(D)for(y.options=JSON.parse(D),S=0,I=y.options.length;S<I;S++)y.items.push(y.options[S][x]);else{var P=h.trim(g.val()||"");if(!O.allowEmptyOption&&!P.length)return;for(S=0,I=(_=P.split(O.delimiter)).length;S<I;S++)(F={})[C]=_[S],F[x]=_[S],y.options.push(F);y.items=_}},n=function(g,y){var D,P,A,z,T=y.options,q={},s=function(h){var g=$&&h.attr($);return"string"==typeof g&&g.length?JSON.parse(g):null},t=function(g,$){g=h(g);var _=k(g.val());if(_||O.allowEmptyOption)if(q.hasOwnProperty(_)){if($){var F=q[_][I];F?h.isArray(F)?F.push($):q[_][I]=[F,$]:q[_][I]=$}}else{var D=s(g)||{};D[C]=D[C]||g.text(),D[x]=D[x]||_,D[S]=D[S]||g.prop("disabled"),D[I]=D[I]||$,q[_]=D,T.push(D),g.is(":selected")&&y.items.push(_)}};for(y.maxItems=g.attr("multiple")?null:1,D=0,P=(z=g.children()).length;D<P;D++)"optgroup"===(A=z[D].tagName.toLowerCase())?function(g){var O,$,C,x,I;for((C=(g=h(g)).attr("label"))&&((x=s(g)||{})[_]=C,x[F]=C,x[S]=g.prop("disabled"),y.optgroups.push(x)),O=0,$=(I=h("option",g)).length;O<$;O++)t(I[O],C)}(z[D]):"option"===A&&t(z[D])};return this.each((function(){if(!this.selectize){var $=h(this),C=this.tagName.toLowerCase(),x=$.attr("placeholder")||$.attr("data-placeholder");x||O.allowEmptyOption||(x=$.children('option[value=""]').text());var S={placeholder:x,options:[],optgroups:[],items:[]};"select"===C?n($,S):m($,S),new w($,h.extend(!0,{},y,S,g))}}))},h.fn.selectize.defaults=w.defaults,h.fn.selectize.support={validity:x},w.define("drag_drop",(function(g){if(!h.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var y=this;y.lock=function(){var h=y.lock;return function(){var g=y.$control.data("sortable");return g&&g.disable(),h.apply(y,arguments)}}(),y.unlock=function(){var h=y.unlock;return function(){var g=y.$control.data("sortable");return g&&g.enable(),h.apply(y,arguments)}}(),y.setup=function(){var g=y.setup;return function(){g.apply(this,arguments);var O=y.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:y.isLocked,start:function(h,g){g.placeholder.css("width",g.helper.css("width")),O.css({overflow:"visible"})},stop:function(){O.css({overflow:"hidden"});var g=y.$activeItems?y.$activeItems.slice():null,$=[];O.children("[data-value]").each((function(){$.push(h(this).attr("data-value"))})),y.setValue($),y.setActiveItem(g)}})}}()}})),w.define("dropdown_header",(function(g){var y=this;g=h.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(h){return'<div class="'+h.headerClass+'"><div class="'+h.titleRowClass+'"><span class="'+h.labelClass+'">'+h.title+'</span><a href="javascript:void(0)" class="'+h.closeClass+'">&times;</a></div></div>'}},g),y.setup=function(){var O=y.setup;return function(){O.apply(y,arguments),y.$dropdown_header=h(g.html(g)),y.$dropdown.prepend(y.$dropdown_header)}}()})),w.define("optgroup_columns",(function(g){var y=this;g=h.extend({equalizeWidth:!0,equalizeHeight:!0},g),this.getAdjacentOption=function(g,y){var O=g.closest("[data-group]").find("[data-selectable]"),$=O.index(g)+y;return $>=0&&$<O.length?O.eq($):h()},this.onKeyDown=function(){var h=y.onKeyDown;return function(g){var O,$,C,x;return!this.isOpen||37!==g.keyCode&&39!==g.keyCode?h.apply(this,arguments):(y.ignoreHover=!0,O=(x=this.$activeOption.closest("[data-group]")).find("[data-selectable]").index(this.$activeOption),void(($=(C=(x=37===g.keyCode?x.prev("[data-group]"):x.next("[data-group]")).find("[data-selectable]")).eq(Math.min(C.length-1,O))).length&&this.setActiveOption($)))}}();var d=function(){var h,g=d.width,y=document;return void 0===g&&((h=y.createElement("div")).innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',h=h.firstChild,y.body.appendChild(h),g=d.width=h.offsetWidth-h.clientWidth,y.body.removeChild(h)),g},e=function(){var O,$,C,x,S,I,_;if(($=(_=h("[data-group]",y.$dropdown_content)).length)&&y.$dropdown_content.width()){if(g.equalizeHeight){for(C=0,O=0;O<$;O++)C=Math.max(C,_.eq(O).height());_.css({height:C})}g.equalizeWidth&&(I=y.$dropdown_content.innerWidth()-d(),x=Math.round(I/$),_.css({width:x}),$>1&&(S=I-x*($-1),_.eq($-1).css({width:S})))}};(g.equalizeHeight||g.equalizeWidth)&&(S.after(this,"positionDropdown",e),S.after(this,"refreshOptions",e))})),w.define("remove_button",(function(g){g=h.extend({label:"&times;",title:"Remove",className:"remove",append:!0},g),"single"!==this.settings.mode?function(g,y){var O=g,$='<a href="javascript:void(0)" class="'+y.className+'" tabindex="-1" title="'+l(y.title)+'">'+y.label+"</a>";g.setup=function(){var C=O.setup;return function(){if(y.append){var x=O.settings.render.item;O.settings.render.item=function(h){return function(h,g){var y=h.search(/(<\/[^>]+>\s*)$/);return h.substring(0,y)+g+h.substring(y)}(x.apply(g,arguments),$)}}C.apply(g,arguments),g.$control.on("click","."+y.className,(function(g){if(g.preventDefault(),!O.isLocked){var y=h(g.currentTarget).parent();O.setActiveItem(y),O.deleteSelection()&&O.setCaret(O.items.length)}}))}}()}(this,g):function(g,y){y.className="remove-single";var O=g,$='<a href="javascript:void(0)" class="'+y.className+'" tabindex="-1" title="'+l(y.title)+'">'+y.label+"</a>",f=function(g,y){return h("<span>").append(g).append(y)};g.setup=function(){var C=O.setup;return function(){if(y.append){var x=h(O.$input.context).attr("id"),S=(h("#"+x),O.settings.render.item);O.settings.render.item=function(h){return f(S.apply(g,arguments),$)}}C.apply(g,arguments),g.$control.on("click","."+y.className,(function(h){h.preventDefault(),O.isLocked||O.clear()}))}}()}(this,g)})),w.define("restore_on_backspace",(function(h){var g=this;h.text=h.text||function(h){return h[this.settings.labelField]},this.onKeyDown=function(){var y=g.onKeyDown;return function(g){var O,$;return 8===g.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&(O=this.caretPos-1)>=0&&O<this.items.length?($=this.options[this.items[O]],this.deleteSelection(g)&&(this.setTextboxValue(h.text.apply(this,[$])),this.refreshOptions(!0)),void g.preventDefault()):y.apply(this,arguments)}}()})),w}));